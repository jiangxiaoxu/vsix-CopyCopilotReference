<platformUI:DialogWindow x:Class="CopyCopilotReference.TabSelectionDialog"
                         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                         xmlns:platformUI="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Shell.15.0"
                         xmlns:vsui="clr-namespace:Microsoft.VisualStudio.PlatformUI;assembly=Microsoft.VisualStudio.Shell.15.0"
                         xmlns:vsShell="clr-namespace:Microsoft.VisualStudio.Shell;assembly=Microsoft.VisualStudio.Shell.15.0"
                         xmlns:shell="clr-namespace:System.Windows.Shell;assembly=PresentationFramework"
                         Title="Copy Copilot References"
                         SizeToContent="WidthAndHeight"
                         WindowStartupLocation="CenterOwner"
                         WindowStyle="None"
                         AllowsTransparency="True"
                         Background="Transparent">
    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome CaptionHeight="0" CornerRadius="6" GlassFrameThickness="0" UseAeroCaptionButtons="False"/>
    </shell:WindowChrome.WindowChrome>

    <platformUI:DialogWindow.Resources>
        <Style x:Key="ThemeButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowButtonInactiveBrushKey}}"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowTextBrushKey}}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBorderBrushKey}}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="4,2"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="2"
                                SnapsToDevicePixels="True">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" RecognizesAccessKey="True"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowButtonHoverActiveBrushKey}}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowButtonDownBrushKey}}"/>
                            </Trigger>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBorderBrushKey}}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ThemeCloseButtonStyle" TargetType="Button" BasedOn="{StaticResource ThemeButtonStyle}">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="28"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Background" Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}"/>
            <Setter Property="Foreground" Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowTextBrushKey}}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="2">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowButtonHoverActiveBrushKey}}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowButtonDownBrushKey}}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </platformUI:DialogWindow.Resources>

    <Border Background="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}"
            BorderBrush="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBorderBrushKey}}"
            BorderThickness="1"
            CornerRadius="6"
            SnapsToDevicePixels="True">
        <Grid Margin="0" SnapsToDevicePixels="True">
            <Grid.RowDefinitions>
                <RowDefinition Height="36"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0"
                  Background="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}"
                  MouseDown="Header_MouseDown">
                <TextBlock Text="Copy Copilot References"
                           Foreground="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowTextBrushKey}}"
                           VerticalAlignment="Center"
                           Margin="12,0,0,0"
                           FontWeight="SemiBold"/>
                <Button Content="&#xE711;"
                        FontFamily="Segoe MDL2 Assets"
                        ToolTip="Close"
                        Width="36"
                        Height="28"
                        HorizontalAlignment="Right"
                        Margin="0,4,4,4"
                        Click="OnCloseClick"
                        Style="{StaticResource ThemeCloseButtonStyle}"/>
            </Grid>

            <ListBox x:Name="ItemsList"
                     Grid.Row="1"
                     ItemsSource="{Binding Items}"
                     MinHeight="{Binding ListHeight}"
                     Focusable="False"
                     Background="{DynamicResource {x:Static vsui:EnvironmentColors.ToolWindowBackgroundBrushKey}}"
                     BorderThickness="0"
                     Style="{DynamicResource {x:Static vsShell:VsResourceKeys.ThemedDialogListBoxStyleKey}}"
                     ScrollViewer.VerticalScrollBarVisibility="Auto"
                     ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                     Margin="12,12,12,0">
                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="Height" Value="{Binding DataContext.RowHeight, RelativeSource={RelativeSource AncestorType=ListBox}}"/>
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="Foreground" Value="{Binding DataContext.ForegroundBrush, RelativeSource={RelativeSource AncestorType=ListBox}}"/>
                        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                        <Setter Property="Focusable" Value="False"/>
                        <EventSetter Event="PreviewMouseLeftButtonDown" Handler="OnItemMouseLeftButtonDown"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsChecked}" Value="True">
                                <Setter Property="Background" Value="{Binding DataContext.HighlightBrush, RelativeSource={RelativeSource AncestorType=ListBox}}"/>
                                <Setter Property="Foreground" Value="{Binding DataContext.HighlightTextBrush, RelativeSource={RelativeSource AncestorType=ListBox}}"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ListBox.ItemContainerStyle>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="{Binding DataContext.CheckboxSpacingWidth, RelativeSource={RelativeSource AncestorType=ListBox}}"/>
                                <ColumnDefinition Width="{Binding DataContext.DirectoryColumnWidth, RelativeSource={RelativeSource AncestorType=ListBox}}"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <CheckBox IsChecked="{Binding IsChecked}"
                                      VerticalAlignment="Center"
                                      Margin="0,0,6,0"
                                      Style="{DynamicResource {x:Static vsShell:VsResourceKeys.ThemedDialogCheckBoxStyleKey}}"/>
                            <TextBlock x:Name="DirectoryText"
                                       Grid.Column="2"
                                       Text="{Binding DirectoryText}"
                                       Foreground="{Binding DataContext.DirectoryBrush, RelativeSource={RelativeSource AncestorType=ListBox}}"
                                       VerticalAlignment="Center"
                                       TextTrimming="CharacterEllipsis"/>
                            <TextBlock x:Name="FileText"
                                       Grid.Column="3"
                                       Text="{Binding FileName}"
                                       Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"
                                       VerticalAlignment="Center"
                                       TextTrimming="CharacterEllipsis"/>
                        </Grid>
                        <DataTemplate.Triggers>
                            <DataTrigger Binding="{Binding IsChecked}" Value="True">
                                <Setter TargetName="DirectoryText" Property="Foreground" Value="{Binding DataContext.HighlightTextBrush, RelativeSource={RelativeSource AncestorType=ListBox}}"/>
                                <Setter TargetName="FileText" Property="Foreground" Value="{Binding DataContext.HighlightTextBrush, RelativeSource={RelativeSource AncestorType=ListBox}}"/>
                            </DataTrigger>
                        </DataTemplate.Triggers>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,12,12,12">
            <Button Content="OK"
                    Width="88"
                    IsDefault="True"
                    Style="{DynamicResource {x:Static vsShell:VsResourceKeys.ThemedDialogButtonStyleKey}}"
                    Click="OnOkClick"/>
            <Button Content="Cancel"
                    Width="88"
                    IsCancel="True"
                    Style="{DynamicResource {x:Static vsShell:VsResourceKeys.ThemedDialogButtonStyleKey}}"
                    Margin="8,0,0,0"/>
        </StackPanel>
        </Grid>
    </Border>
</platformUI:DialogWindow>
